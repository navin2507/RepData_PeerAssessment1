{
    "contents" : "---\ntitle: \"RepData_PeerAssessment1\"\nauthor: \"Navin Bhatera\"\ndate: \"Monday, March 16, 2015\"\noutput: html_document\n---\n\nThis document contains the Peer Assignment 1 for Reproducible Research course as part of Data Science specialization at Coursera\n\nLoading and Preprocessing data : \n```{r first,echo = TRUE}\nlibrary(ggplot2)\nactivity <- read.csv(\"activity.csv\",header=T,colClasses=c(\"numeric\", \"character\", \"numeric\"))\nactivity$date <- as.Date(activity$date, format = \"%Y-%m-%d\")\nactivity$interval <- as.factor(activity$interval)\nstr(activity)\n```\n\nHistogram for the processed data (excluding NA's)\n\n```{r second,echo=TRUE}\ndaysteps <- tapply(activity$steps, activity$date, FUN=sum, na.rm=T)\nhist(daysteps,main=\"Number of steps taken per day\", xlab=\"Steps\", col=\"red\",breaks=10)\n\n```\n\nThe mean of steps taken per day is \n\n```{r third,echo=TRUE}\nmean(daysteps, na.rm=T)\n```\n\nThe median of steps taken per day is \n\n```{r fourth,echo=TRUE}\nmedian(daysteps, na.rm=T)\n```\n\nAvergage daily actiity pattern is plotted below\n```{r fifth, echo=TRUE}\ndaysteps_mean <- aggregate(x=list(steps=activity$steps), by = list(interval=activity$interval),\n                           FUN=mean, na.rm=T)\ndaysteps_mean$interval <- as.integer(levels(daysteps_mean$interval)[daysteps_mean$interval])\nggplot(daysteps_mean, aes(x=interval, y=steps)) +   \n    geom_line(color=\"red\", size=1) +  \n    labs(title=\"Average Daily Activity Pattern\", x=\"Interval\", y=\"Steps\")\n```\n\nMax number of steps for a particular 5-min interval can be located at \n\n```{r sixth, echo=TRUE}\ndaysteps_mean[which.max(daysteps_mean$steps),]\n```\n\n\nNew dataset creation: (using mean of the day as filler)\n\n```{r seventh, echo=TRUE}\nfillstep <- function(steps, int) {\n  temp = 0\n  if (!is.na(steps)) temp = steps\n  else temp = daysteps_mean[daysteps_mean$interval == int, \"steps\"]\n  return(temp)\n  }\nactivity_fill <- activity\nactivity_fill$steps <- mapply(fillstep,activity_fill$steps,activity_fill$interval)\n```\n\nHistogram Plot with the new data set: (NA's replaced by Day Mean)\n\n```{r eight, echo=TRUE}\ndaysteps_fill <- tapply(activity_fill$steps, activity_fill$date, FUN=sum, na.rm=T)\nhist(daysteps_fill, main=\"Number of steps taken per day\", xlab=\"Steps\",col=\"blue\",breaks=10)\n\n```\n\n\nThe mean of steps taken per day is \n\n```{r ninth,echo=TRUE}\nmean(daysteps_fill)\n```\n\nThe median of steps taken per day is \n\n```{r tenth,echo=TRUE}\nmedian(daysteps_fill)\n```\n\n\nNow evaluating the difference between weekdays and weekend activity pattern: \n\n```{r eleventh, echo=TRUE}\nweekdaytype <- function(date){\n  day <- weekdays(date)\n  if (day %in% c(\"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\"))\n    return(\"weekday\") \n  else if (day %in% c(\"Saturday\", \"Sunday\")) \n    return(\"weekend\")\n  else stop(\"invalid date\")\n  }\nactivity_fill$day <- sapply(activity_fill$date, FUN = weekdaytype)\n\ndaytype_mean <- aggregate(steps ~ interval + day, data = activity_fill, mean)\nggplot(daytype_mean, aes(as.numeric(interval), steps)) + geom_line(col=\"blue\") + facet_grid(day ~ .) + labs(title=\"Average Daily Activity Pattern\", x=\"Interval\", y=\"Steps\") + theme_bw()\n\n```\n",
    "created" : 1426451664479.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2874768933",
    "id" : "BAC63A9C",
    "lastKnownWriteTime" : 1426453791,
    "path" : "C:/Users/105067164/Desktop/Analytics/Reproducible_research/RepData_PeerAssessment1.Rmd",
    "project_path" : "RepData_PeerAssessment1.Rmd",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : false,
    "type" : "r_markdown"
}